FROM python:3.13-slim

WORKDIR /app

ARG LANGGRAPH_ASSISTANT_ID
ARG LANGGRAPH_API_ENDPOINT
ARG GRAFANA_TO_LANGGRAPH_PROXY_PORT

ENV LANGGRAPH_ASSISTANT_ID=${LANGGRAPH_ASSISTANT_ID} \
    LANGGRAPH_API_ENDPOINT=${LANGGRAPH_API_ENDPOINT} \
    GRAFANA_TO_LANGGRAPH_PROXY_PORT=${GRAFANA_TO_LANGGRAPH_PROXY_PORT}

COPY . /app

RUN pip install --no-cache-dir fastapi uvicorn httpx

CMD ["sh", "-c", "uvicorn app:app --host 0.0.0.0 --port ${GRAFANA_TO_LANGGRAPH_PROXY_PORT}"]